# SeatMate - 좌석 배정 시스템

SeatMate는 교실이나 강의실에서 학생들의 좌석을 자동으로 배정하는 웹 애플리케이션입니다. 성별에 따라 좌석을 구분하여 배정하며, 각 사용자는 자신의 좌석만 볼 수 있습니다.

## 주요 기능

- 4x10 좌석 그리드 레이아웃
- 성별 기반 좌석 배정 (남성: 연한 초록색, 여성: 연한 분홍색)
- 개인정보 보호: 사용자는 자신의 배정된 좌석만 볼 수 있음
- 로컬 스토리지를 사용한 영구적인 좌석 배정
- 성별 선택 및 배정 버튼이 있는 간단한 인터페이스
- 학생 정보 입력 불필요
- 좌석 번호 눈에 띄게 표시
- 중복 배정 방지 기능

## 기술 스택

- HTML, CSS, JavaScript (프론트엔드)
- Supabase (백엔드 데이터베이스)
- PostgreSQL 함수 (동시성 제어)

## 동시성 문제 해결 방법

이 프로젝트는 여러 사용자가 동시에 좌석을 선택할 때 발생할 수 있는 경쟁 상태(race condition)를 해결하기 위해 다음과 같은 방법을 사용합니다:

1. **PostgreSQL 트랜잭션 및 FOR UPDATE 잠금**
   - 좌석 할당 시 원자적 트랜잭션을 사용하여 동시 접근을 제어합니다.
   - `SELECT ... FOR UPDATE` 구문을 사용하여 좌석 레코드에 잠금을 걸어 다른 트랜잭션의 접근을 방지합니다.

2. **서버 측 좌석 할당 로직**
   - 좌석 할당 로직을 클라이언트가 아닌 서버(PostgreSQL 함수)에서 처리하여 일관성을 보장합니다.
   - 동시 요청이 발생해도 데이터베이스 수준에서 순차적으로 처리됩니다.

3. **실패 시 자동 재시도 메커니즘**
   - 좌석 할당에 실패할 경우 자동으로 다른 좌석을 찾아 재시도합니다.
   - 사용자에게 명확한 오류 메시지를 제공합니다.

## 설치 및 실행 방법

1. 저장소 클론:
   ```
   git clone https://github.com/yourusername/SeatMate.git
   cd SeatMate
   ```

2. 웹 서버로 실행:
   - 로컬 웹 서버를 사용하여 프로젝트 폴더를 호스팅합니다.
   - 예: Python의 내장 웹 서버 사용:
     ```
     python -m http.server
     ```
   - 또는 VS Code의 Live Server 확장 프로그램 사용

3. 브라우저에서 열기:
   - 브라우저에서 `http://localhost:8000` 또는 웹 서버가 제공하는 URL 열기

## Supabase 설정

1. Supabase 계정 생성 및 새 프로젝트 설정
2. SQL 에디터에서 `sql/setup_tables.sql` 실행하여 필요한 테이블 생성
3. SQL 에디터에서 `sql/reserve_seat_function.sql` 실행하여 PostgreSQL 함수 생성
4. `supabase-config.js` 파일에서 Supabase URL과 API 키 확인

## 관리자 기능

- `admin.html` 페이지에서 모든 좌석 상태 확인 가능
- 모든 좌석 초기화 기능 제공
- 실시간 좌석 상태 업데이트 확인 가능

## 라이센스

MIT License
